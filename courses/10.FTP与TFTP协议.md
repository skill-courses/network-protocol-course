# FTP 与TFTP 协议

![ftp](../images/ftp.jpg)

在互联网上，下载和上传文件是非常容易的事情，但是在这非常容易的背后，是FTP和TFTP协议为我们做了很多工作，今天我们就来学习它！

## FTP协议

FTP（File Transfer Protocol）是一种用于在计算机网络上进行文件传输的协议。它是一种标准的客户端-服务器协议，采用TCP协议，用于从一个主机向另一个主机传输文件。FTP客户端可以使用用户名和密码登录到FTP服务器，并且可以通过FTP协议进行上传和下载文件操作。

FTP协议主要应用于需要大量文件传输的场景，例如网站维护人员需要上传或下载网站文件、音视频文件、软件文件等。在互联网的早期，FTP是互联网上传输文件最主要的协议之一。但是，在安全性方面，FTP协议不够强，数据传输时不加密，FTP登录时使用的账户密码信息也不加密，容易被恶意攻击者窃取。

FTP协议的工作原理是基于客户端-服务器模型，客户端通过FTP协议连接到FTP服务器，并向服务器发送命令，服务器响应命令并执行相关操作，例如列出目录、下载文件、上传文件等。FTP协议使用两个端口进行数据传输，一个端口(21)用于控制连接，另一个端口(20)用于数据传输。

### 主动模式和被动模式

FTP协议中，数据连接可以使用主动模式或被动模式。

在主动模式中，客户端使用随机端口号向服务器的FTP数据端口20发起连接请求，服务器将响应该请求并将数据发送到客户端的指定端口号。在主动模式下，客户端主动打开数据连接，服务器被动等待客户端的连接请求。

在被动模式中，服务器使用随机端口号向客户端的FTP控制端口21发起连接请求，客户端将响应该请求并建立数据连接。在被动模式下，服务器主动打开数据连接，客户端被动等待服务器的连接请求。

主动模式需要允许客户端向服务器的FTP数据端口发起连接请求，而被动模式则需要服务器向客户端的FTP控制端口发起连接请求。通常情况下，被动模式被视为更安全和可靠的模式，因为它可以通过防火墙等网络设备更好地控制数据连接。

### 优劣

FTP协议的价值优势在于其支持大文件传输，同时也支持断点续传，可以在网络不稳定的情况下保证文件传输的可靠性和完整性。但是，由于FTP协议的数据传输不加密，容易被恶意攻击者截获和窃取，因此FTP协议在安全性方面存在一定的风险。为了解决FTP协议的安全性问题，通常会使用加密的FTP协议（如SFTP）或使用VPN等加密技术来保证数据传输的安全性。

## TFTP

TFTP（Trivial File Transfer Protocol）是一种简单的文件传输协议，它是在FTP协议的基础上进行简化和优化的，旨在提供一种轻量级的文件传输解决方案。TFTP通常用于在局域网环境中进行固件升级、配置文件传输等场景中。

TFTP协议采用UDP协议作为传输层协议，它的工作原理基于请求-响应模型，客户端向服务器发起请求，服务器返回请求的文件或信息。TFTP使用的是8位无符号整数来表示数据块号，每个数据包的最大长度为512字节，相较于FTP协议来说，TFTP传输的数据量较小，传输效率较低，但是它具有传输速度快、实现简单、使用方便等优点。

TFTP的缺点是传输安全性差，传输的文件不进行加密或验证，容易被篡改或窃取，因此在安全要求较高的场景下不适合使用。

## TFP VS TFTP

TFTP和FTP是两种常见的文件传输协议，它们之间有以下比较：
* 功能：FTP比TFTP功能更强大，支持多种文件传输模式和权限控制。TFTP则只支持简单的读写文件。
* 端口号：FTP使用TCP的端口号20和21，而TFTP使用UDP的端口号69。
* 安全性：FTP支持加密传输，而TFTP没有加密选项，数据传输是明文的。
* 可靠性：FTP使用TCP连接，可以保证数据的可靠传输，而TFTP使用UDP，传输数据可能会出现丢失或重复。
* 应用场景：FTP适用于需要传输大文件或者需要权限控制的场景，如网站文件更新、备份恢复等。TFTP则适用于小文件传输，如网络设备配置文件、无盘工作站启动文件等。

总的来说，FTP相对于TFTP功能更强大、更可靠、更安全，但在某些特定场景下，TFTP由于其简单、高效的特点而更为适用。